<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.10 (454269)"/><meta name="author" content="lcx3114@163.com"/><meta name="created" content="2016-01-09 09:23:29 +0000"/><meta name="source-url" content="http://item.jd.com/11773882.html"/><meta name="updated" content="2016-01-11 07:08:12 +0000"/><title>第二章：MongoDB基础知识</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><b>文档</b></div><div>{"greetiong" : "Hello, world!", "foo" : 3}</div><div>区分大小写和类型；键不能使用\0（空字符），这个字符表示键名的结束</div><div><br/></div><div><br/></div><div><b>集合</b></div><div>集合就是一组文档，一个集合下的文档类型可以不相同</div><div><br/></div><div>blog.posts &nbsp;&nbsp;&nbsp;&nbsp;blog.authors </div><div>集合名不能包含\0（空字符），不能以system.开头</div><div><br/></div><div><br/></div><div><b>数据库</b></div><div>多个集合组成数据库</div><div><br/></div><div>cms.blog.posts &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用命名空间取得数据库cms下的集合，命名空间字符应小于100字节 </div><div>数据库名不能使用特殊符号，最多64个字节，最好都使用小写，保留数据库admin、local、config</div><div><br/></div><div><br/></div><div><b>数据类型</b></div><div>{"x" : null} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null </div><div>{"x" : true} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;布尔型 </div><div>{"x" : 3.14} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数值 </div><div>{"x" : "aa"} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;字符串 </div><div>{"x" :&nbsp;&nbsp;new Date()} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;日期 </div><div>{"x" :&nbsp;&nbsp;/foobar/i} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 正则表达式 </div><div>{"x" : ["a","b"]} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 数组，数据类型可以不同，数组还能嵌套数组 </div><div>{"x" :&nbsp;&nbsp;{"y" : "a"}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 内嵌文档 </div><div>{"x" : ObjectId()} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对象Id，文档的唯一值 </div><div>{"x" : function(){}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;代码 </div><div><br/></div><div><br/></div><div><b>MongoDB shell使用</b></div><div>mongo &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;启动shell，连接本机数据库 </div><div>mongo 192.168.1.2:27017/myDB &nbsp;&nbsp;&nbsp;&nbsp; 连接其它服务器的数据库 </div><div>mongo&nbsp;&nbsp;--nodb &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 不连接任何数据库 </div><div>连续按三次回车取消多行未完成的命令</div><div><br/></div><div>conn = new Mongo("192.168.1.2:27017") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shell内创建连接 </div><div>db = conn.getDB("myDB") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shell内连接数据库 </div><div><br/></div><div>bd &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查看指向的数据库 </div><div>use foobar &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 选择数据库，等价函数db.getSisterDB("foobar") </div><div>show dbs &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示所有数据库，等价函数db.getMongo().getDBs() </div><div>show collections &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示所有集合，等价函数db.getCollections </div><div><br/></div><div>post={"title" : "aa", "content" : "bb", "date" : new Date()} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;创建变量 </div><div>post.comments="cc" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改变量 </div><div>db.blog.insert(post) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在集合中插入变量 </div><div>db.blog.find() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查看集合中的文档，自动显示最多20条 </div><div>db.blog.findOne() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看一条集合中的文档 </div><div>db.blog.update({"title" : "aa"}, post) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;更新集合 </div><div>db.blog.remove({"title" : "aa"}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;删除集合中的文档，没有参数全部删除 </div><div>也可使用db["blog"]访问集合</div><div><br/></div><div>help &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查看帮助文档 </div><div>db.help() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看数据库级帮助 </div><div>db.foo.help() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看集合级别帮助 </div><div>db.foo.update &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看函数实现代码 </div><div><br/></div><div>mongo script1.js&nbsp;&nbsp;script2.js &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;执行脚本 </div><div>mongo&nbsp;&nbsp;--quiet 192.168.1.2:27017/myDB&nbsp;&nbsp;script1.js&nbsp;&nbsp;script2.js &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定执行脚本数据库 </div><div>load("script1.js") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shell内执行脚本 </div><div><br/></div><div>用户目录下[.mongorc.js]内添加启动shell自动加载的脚本</div><div>mongo&nbsp;&nbsp;--norc &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 启动shell不加载[.mongorc.js] </div><div><br/></div><div>prompt = function() {return (new Date())+">";}; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;改变命令行前面的提示符 </div><div><br/></div><div><br/></div><div><b><br/></b></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>