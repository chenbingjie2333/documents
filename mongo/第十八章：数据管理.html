<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.10 (454269)"/><meta name="author" content="lcx3114@163.com"/><meta name="created" content="2016-01-20 12:42:24 +0000"/><meta name="updated" content="2016-01-21 12:33:07 +0000"/><title>第十八章：数据管理</title></head><body><div><b>配置身份验证</b></div><div>admin和local数据库的用户为管理员用户，一个数据库上可以有多个用户，admin用户没有则本地客户端可对数据库进行读写</div><div>db.createUser({user : "appAdmin", pwd : "password", roles : ["readWrite", "dbAdmin", {role : "readAnyDatabase", db : "admin"}]}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;创建用户 </div><div>启动时加上--auth参数开启用户验证</div><div>db.auth("appAdmin ", "password ") &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 登录用户 </div><div>用户信息保存在db.system.users集合中</div><div><br/></div><div><br/></div><div><b>预热数据</b></div><div>db.runCommand({"touch" : "logs", "date" : true, "index" : true}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将指定集合和索引载入内存 </div><div><br/></div><div>db.adminCommand({"diagLogging" : 2}) &nbsp;&nbsp;&nbsp;&nbsp; 开启诊断日志；0：关闭；1：记录写入操作；2：记录读取；3：记录读写 </div><div><br/></div><div><br/></div><div><b>压缩数据</b></div><div>db.runCommand({"compact" : "collName"}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;压缩重整集合，不会释放磁盘空间，只是都移到集合磁盘空间的前面 </div><div>db.runCommand({"compact" : "collName", "paddingFactor" : 1.5}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;指定额外间隔，只影响压缩的数据 </div><div><br/></div><div><br/></div><div><b>移动集合</b></div><div>db.sourceColl.renameCollection("newName") &nbsp;&nbsp;&nbsp;&nbsp; 集合重命名，加入第二个参数给定重名时的规则（true删除重名的集合） </div><div>db.runCommand({"cloneCollection" : "colName", "from" : "hostname:27017"}) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将一个集合移动到另一个mongod中 </div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>